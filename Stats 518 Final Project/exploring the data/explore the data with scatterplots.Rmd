---
title: "Exploring the Data with Scatter Plots"
author: "brooke"
date: "7/16/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Exploring the Data With Scatter Plots"

I created four dynamic scatter plot tables that show the county by county relationships between  covid-19 mortality  and :
- [public housing assistance rate]()
- [median age]()
- [median income]()
- [higher education attainment]()


the data will be exported into a CVS file and transformed into an aesthetically pleasing dynamic table 




The script below:

1) Divides the data into quintiles by covid-19 morbidity rate per 1,000 population
2) Updates variables names into a descriptive format
3) Create 4 interactive scatter plots of Michigan counties
4) Export plots for as jpegs in the portfolio repository 



## Step 1
 - Load plotly and tidyverse
#install package if needed

```{r load ploty}
library(plotly)
library(tidyverse)
```


## Step 2
- create quintiles for an added layer the scatter plots

```{r create quintiles}
covid_quintile <- covid_census %>% 
  select(population19E, householdsE, median_ageE, median_incomeE, bach_degree_plus_a25E, unemployment_rate, public_assist_rate, percent_asian, percent_black, percent_native, percent_pacific_islander, percent_white, percent_hispanic, County, Total_Deaths, Deaths_Per_Pop_Thousand) %>% 
  mutate(covid_mortality_quintile = ntile(Deaths_Per_Pop_Thousand,5))
```

1 = lowest Covid deaths per 1,000
5 = highest Covid deaths per 1,000


## Step 3
- Convert the quintile numbers into factors, so the variable can have discrete formatting in the plots


```{r convert to factors}
covid_quintile$covid_mortality_quintile <-  covid_quintile$covid_mortality_quintile %>%  as.factor 
```


## Step 4
- Convert data into tibble for ease of wrangling

```{r tibble}
covid_quintile <- tibble(covid_quintile)
```

## Step 5 
- Export this data for another project, I'll update the names next and I don't want this to interfere with my calculations


```{r write CSV for bootstrapping}

write.csv(covid_quintile,"~/STA 518/BrookemWalters-Portfolio/Stats 518 Final Project/Bootstrapping/covid_census_bs.csv")
```




## Step 6
- Update variable with descriptive names, the other set of descriptive names caused an error if used before this point due to the symbols used

```{r update names}

covid_quintile_chart <-  covid_quintile %>% 
  rename( 
    Population = "population19E",
    Households = "householdsE",
    `Median Age` = "median_ageE",
    `Median Household Income` = "median_incomeE",
    `% A25+ College Grad+` = "bach_degree_plus_a25E",
    `% of HH on Public Assist.` = "public_assist_rate",
    `Unemployment Rate` = "unemployment_rate",
    `% Asian` = "percent_asian",
    `% Black` = "percent_black",    
    `% Native American` = "percent_native", 
    `% Pacific Islander` = "percent_pacific_islander",
    `% White` = "percent_white",            
    `% Hispanic` = "percent_hispanic",
    `Total Covid Deaths` = "Total_Deaths",
    `Covid Deaths Per Thousand` = "Deaths_Per_Pop_Thousand"
  )
```

## Step 7
 - Create a color pallet for quintiles
```{r create customer color pa;;et}
mortal_palette <-  c("#999999", "#00798c", "#66a182", "#edae49", "#dc0000b2")
```
 


-## Steps 8-12
- create a scatter plot showing the  relationship between Covid Deaths per 1000, Total Covid Death, Quintiles, 
- update the x axis with the desired variable, and update the title to reflect the changes


```{r housing assistance plots}
assist_sp <- covid_quintile_chart %>% 
  ggplot( aes(x = `% of HH on Public Assist.`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=covid_mortality_quintile, text=County)) +
  geom_point(alpha = 6/10) +
  scale_size_continuous(range = c(2, 15)) +
  labs(title = "Michigan Covid Mortality (quintiles) by % of HHs on Assistance", color = "Quintile", size = NULL) +
  scale_color_manual(values = mortal_palette) 

#save the static plot to the "plots" folder
jpeg(filename = "~/STA 518/BrookemWalters-Portfolio/Stats 518 Final Project/Plots/assist_sp.jpeg",
      width = 1000, height = 650)
assist_sp 


# display the interactive version
ia_assist_sp <-  ggplotly(assist_sp )
ia_assist_sp
```


```{r median age plots}

# static version
age_sp <- covid_quintile_chart %>% 
  ggplot( aes(x = `Median Age`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=covid_mortality_quintile, text=County)) +
  geom_point(alpha = 6/10) +
  scale_size_continuous(range = c(2, 15)) +
  labs(title = "Mortality (quintiles) by Median Age in Michigan Counties", color = "Quintile", size = NULL) +
  scale_color_manual(values = mortal_palette) 

#save the static plot to the "plots" folder
jpeg(filename = "~/STA 518/BrookemWalters-Portfolio/Stats 518 Final Project/Plots/age_sp.jpeg",
     width = 1000, height = 650)
age_sp 


# display the interactive version
ia_age_sp <-ggplotly(age_sp)
ia_age_sp
```


```{r education plots}
ed_sp <- covid_quintile_chart %>% 
  ggplot( aes(x = `% A25+ College Grad+`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=covid_mortality_quintile, text=County)) +
  geom_point(alpha = 6/10) +
  scale_size_continuous(range = c(2, 15)) +
  labs(title = "Mortality by Higher Education Attainment in Michigan Counties", color = "Quintile", size = NULL) +
  scale_color_manual(values = mortal_palette) 

#save the static plot to the "plots" folder
jpeg(filename = "~/STA 518/BrookemWalters-Portfolio/Stats 518 Final Project/Plots/ed_sp.jpeg",
      width = 1000, height = 650)
ed_sp

# display the interactive version
ia_ed_sp <- ggplotly(ed_sp )
ia_ed_sp
```


```{r income plots}
income_sp <- covid_quintile_chart %>% 
  ggplot( aes(x = `Median Household Income`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color= covid_mortality_quintile, text=County)) +
  geom_point(alpha = 6/10) +
  scale_size_continuous(range = c(2, 15)) +
 labs(title ="Covid Mortality (quintiles) by Median Household Income in Michigan Counties", color = "Quintile", size = NULL) +
  scale_color_manual(values = mortal_palette) 

#save the static plot to the "plots" folder
jpeg(filename = "~/STA 518/BrookemWalters-Portfolio/Stats 518 Final Project/Plots/income_sp.jpeg",
      width = 1000, height = 650)
income_sp

# display the interactive version
ia_income_sp <- ggplotly(income_sp )
ia_income_sp
```




###### ---[Back to Table of Contents](https://github.com/BrookemWalters/BrookemWalters-Portfolio#table-of-contents-brooke-walters-portfolio)---



