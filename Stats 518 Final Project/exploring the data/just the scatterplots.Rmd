---
title: "Exploring the Data with Scatter Plots"
author: "brooke"
date: "7/16/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




# Exploring the Data With Scatter Plots"

I created four dynamic scatter plot tables that show the county by county relationships between  covid-19 morbity and :
- public housing assistance rate 
- median age
- median income
- higher education attainment
- 


## Steps 6 - 10
- create a scatter plot showing the  relationship between Covid Deaths per 1000, Total Covid Death, Quintiles, 
- update the x axis with the desired variable, and update the title to reflect the changes


```{r}
library(tidyverse, plotly)
```


THE LEGEND NEEDS TO BE FIXED TO REFLECT THE BUBBLE SIZE

```{r housing assistance plots}
assist_sp <- covid_quintile %>% 
  ggplot( aes(x = `% of Households on Public Assistance`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=Quintile, text=County)) +
  geom_point(alpha = 6/10) +
  ggtitle("% of Michigan HHs on Assistance by Covid Deaths Per Thousand" ) +
 theme(panel.background = element_rect(fill = "white",
                                colour = "beige",
                                size = 0.5, linetype = "solid")) +
         
  scale_color_manual(values = c("#999999", "#00798c", "#66a182", "#edae49", "#dc0000b2")) 




ggplotly(assist_sp )
```
```{r median age plots}
age_sp <- covid_quintile %>% 
  ggplot( aes(x = `Median Age`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=Quintile, text=County)) +
  geom_point(alpha = 6/10) +
  ggtitle("Median Age in Michigan Counties by Covid Deaths Per Thousand" ) +
 theme(panel.background = element_rect(fill = "white",
                                colour = "beige",
                                size = 0.5, linetype = "solid")) +
         
  scale_color_manual(values = c("#999999", "#00798c", "#66a182", "#edae49", "#dc0000b2")) 




ggplotly(age_sp )
```


```{r education plots}
ed_sp <- covid_quintile %>% 
  ggplot( aes(x = `% of Adults 25+ with College Degrees`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=Quintile, text=County)) +
  geom_point(alpha = 6/10) +
  ggtitle("Higher Education Attainment in Michigan Counties by Covid Deaths Per Thousand" ) +
 theme(panel.background = element_rect(fill = "white",
                                colour = "beige",
                                size = 0.5, linetype = "solid")) +
         
  scale_color_manual(values = c("#999999", "#00798c", "#66a182", "#edae49", "#dc0000b2")) 




ggplotly(ed_sp )
```


```{r income plots}
income_sp <- covid_quintile %>% 
  ggplot( aes(x = `Median Household Income`, y = `Covid Deaths Per Thousand`, size = `Total Covid Deaths`, color=Quintile, text=County)) +
  geom_point(alpha = 6/10) +
  ggtitle("Median Household Income in Michigan Counties by Covid Deaths Per Thousand" ) +
 theme(panel.background = element_rect(fill = "white",
                                colour = "beige",
                                size = 0.5, linetype = "solid")) +
         
  scale_color_manual(values = c("#999999", "#00798c", "#66a182", "#edae49", "#dc0000b2")) 




ggplotly(income_sp )
```
